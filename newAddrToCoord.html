<!DOCTYPE HTML>
<html>

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10, user-scalable=yes">

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

    <title>신주소를 좌표로</title>
    <script type="text/javascript">
        var timeObj = null;

        $(function () {
            $('#btn').on('click', function () {
                $('#result').html('');
                var text = $('#searchText').val();
                var splitTxt = text.split(',');

                var i = 0;

                if (timeObj) {
                    clearInterval(timeObj);
                }

                timeObj = setInterval(function () {
                    if ((i + 1) >= splitTxt.length) {
                        clearInterval(timeObj);
                    }

                    $.ajax({
                        url: 'http://www.juso.go.kr/addrlink/addrLinkApiJsonp.do'
                        , type: 'POST'
                        , data: {
                            confmKey: 'U01TX0FVVEgyMDE4MTIxMTE2MzYyNDEwODM2MTE=',
                            currentPage: 1,
                            countPerPage: 1,
                            keyword: splitTxt[i],
                            resultType: 'json'
                        }
                        , dataType: 'jsonp'
                        , crossDomain: true
                        , success: function (jsonStr) {
                            var split  = splitTxt[i];
                            if (jsonStr.results.juso) {
                                if (jsonStr.results.juso.length > 0) {
                                    //$('#result').append((i + 1) + '. ' + splitTxt[i] + ' - ' + jsonStr.results.juso[0].admCd + '<br />');
                                    var paramObj = jsonStr.results.juso[0];
                                    $.ajax({
                                        url: 'http://www.juso.go.kr/addrlink/addrCoordApiJsonp.do'
                                        , type: 'POST'
                                        , data: {
                                            confmKey: 'U01TX0FVVEgyMDE5MDUyMTE0MTMwODEwODc0NDI=',
                                            admCd: paramObj.admCd,
                                            rnMgtSn: paramObj.rnMgtSn,
                                            udrtYn: paramObj.udrtYn,
                                            buldMnnm: paramObj.buldMnnm,
                                            buldSlno: paramObj.buldSlno,
                                            resultType: 'json'
                                        }
                                        , dataType: 'jsonp'
                                        , crossDomain: true
                                        , success: function (jsonStr) {
                                            $('#result').append((i + 1) + '. ' + split + '-' + jsonStr.results.juso[0].bdNm + ' - ' + jsonStr.results.juso[0].entX + ',' + jsonStr.results.juso[0].entY + '<br />');
                                        }
                                    });
                                } else {
                                    $('#result').append((i + 1) + '. ' + splitTxt[i] + ' - ' + 'X' + '<br />');
                                }
                            } else {
                                $('#result').append((i + 1) + '. ' + splitTxt[i] + ' - ' + 'X' + '<br />');
                            }

                            i++;

                        }
                        , error: function (xhr, status, error) {
                        }
                    });

                }, 1000);

            })
        });

    </script>
</head>

<body>
    <input id="searchText" type="text" />
    <input id="btn" type="button" value="변환" />
    <div> ================================================= <br />
        1. 한줄로 <br />
        2. 쉼표로 연결 (인천광역시 연수구 테크노파크로 200)<br />
        =================================================
    </div>
    <div id="result">

    </div>
</body>

</html>